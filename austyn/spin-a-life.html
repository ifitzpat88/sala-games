<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<title>Spin-a-Life: World Edition</title>
<style>
/* ============================================================
   SPIN-A-LIFE: WORLD EDITION â€” MEGA EXPANSION
   A Life Simulator RPG by Austyn
   ============================================================ */
*{margin:0;padding:0;box-sizing:border-box;}
:root{
  --sky:#e8f4fd;--sky2:#cce5ff;
  --green:#4caf50;--green-light:#81c784;--green-dark:#2e7d32;
  --blue:#2196f3;--blue-light:#64b5f6;--blue-dark:#1565c0;
  --orange:#ff9800;--orange-light:#ffb74d;
  --red:#f44336;--pink:#e91e63;--purple:#9c27b0;
  --yellow:#ffc107;--brown:#795548;--cyan:#00bcd4;
  --text:#333;--text-light:#666;--card:#ffffff;
  --shadow:0 4px 15px rgba(0,0,0,.1);
  --shadow-lg:0 8px 30px rgba(0,0,0,.15);
  --radius:16px;
}
html,body{
  height:100%;font-family:'Segoe UI','Helvetica Neue',Arial,sans-serif;
  background:linear-gradient(180deg,var(--sky) 0%,var(--sky2) 100%);
  color:var(--text);overflow-x:hidden;
}
body::before,body::after{
  content:'';position:fixed;border-radius:50%;opacity:.4;z-index:0;pointer-events:none;background:white;
}
body::before{width:200px;height:60px;top:30px;left:10%;box-shadow:40px -15px 0 10px white,80px 0 0 5px white;animation:drift 40s linear infinite;}
body::after{width:150px;height:50px;top:80px;right:15%;box-shadow:30px -10px 0 8px white,60px 5px 0 3px white;animation:drift 55s linear infinite reverse;}
@keyframes drift{from{transform:translateX(-120px)}to{transform:translateX(120px)}}

#app{max-width:600px;margin:0 auto;min-height:100vh;position:relative;z-index:1;padding:12px;}
.screen{display:none;animation:fadeUp .4s ease;}
.screen.active{display:block;}
@keyframes fadeUp{from{opacity:0;transform:translateY(15px)}to{opacity:1;transform:translateY(0)}}

.card{background:var(--card);border-radius:var(--radius);padding:20px;margin-bottom:14px;box-shadow:var(--shadow);}
.card-title{font-size:1.1rem;font-weight:700;margin-bottom:10px;display:flex;align-items:center;gap:8px;}

.btn{
  display:inline-flex;align-items:center;justify-content:center;gap:6px;
  padding:12px 20px;font-size:.95rem;font-weight:600;
  border:none;border-radius:12px;cursor:pointer;
  transition:all .15s;font-family:inherit;
  box-shadow:0 3px 8px rgba(0,0,0,.12);color:white;
}
.btn:hover{transform:translateY(-2px);box-shadow:0 5px 15px rgba(0,0,0,.2);}
.btn:active{transform:translateY(0);box-shadow:0 2px 5px rgba(0,0,0,.15);}
.btn:disabled{opacity:.4;cursor:not-allowed;transform:none!important;}
.btn-blue{background:linear-gradient(135deg,var(--blue),var(--blue-dark));}
.btn-green{background:linear-gradient(135deg,var(--green),var(--green-dark));}
.btn-orange{background:linear-gradient(135deg,var(--orange),#e65100);}
.btn-red{background:linear-gradient(135deg,var(--red),#c62828);}
.btn-purple{background:linear-gradient(135deg,var(--purple),#6a1b9a);}
.btn-pink{background:linear-gradient(135deg,var(--pink),#ad1457);}
.btn-yellow{background:linear-gradient(135deg,var(--yellow),#f57f17);color:var(--text);}
.btn-cyan{background:linear-gradient(135deg,var(--cyan),#00838f);}
.btn-sm{padding:8px 14px;font-size:.8rem;border-radius:10px;}
.btn-lg{padding:14px 28px;font-size:1.1rem;border-radius:14px;}
.btn-block{width:100%;margin-bottom:8px;}

#title-screen{text-align:center;padding-top:40px;}
.game-title{font-size:clamp(2rem,7vw,3rem);font-weight:900;background:linear-gradient(135deg,var(--blue),var(--purple),var(--pink));-webkit-background-clip:text;-webkit-text-fill-color:transparent;margin-bottom:4px;}
.game-subtitle{color:var(--text-light);font-size:1rem;margin-bottom:30px;}
.title-globe{font-size:4rem;margin-bottom:10px;animation:spin 8s linear infinite;}
@keyframes spin{from{transform:rotate(0deg)}to{transform:rotate(360deg)}}

.passport-grid{display:flex;flex-direction:column;gap:10px;margin-top:16px;}
.passport-slot{display:flex;align-items:center;gap:14px;padding:16px;background:white;border-radius:14px;border:2px dashed #ddd;cursor:pointer;transition:all .2s;}
.passport-slot:hover{border-color:var(--blue);transform:scale(1.02);}
.passport-slot.filled{border-style:solid;border-color:var(--green-light);}
.passport-icon{font-size:2.2rem;}
.passport-info{flex:1;}
.passport-name{font-weight:700;font-size:1rem;}
.passport-detail{font-size:.75rem;color:var(--text-light);}
.passport-actions{display:flex;gap:6px;}

.name-input{width:100%;padding:14px;font-size:1.1rem;border:2px solid #ddd;border-radius:12px;font-family:inherit;outline:none;transition:border-color .2s;}
.name-input:focus{border-color:var(--blue);}

.country-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:10px;}
.country-card{display:flex;flex-direction:column;align-items:center;padding:16px 8px;background:white;border-radius:14px;border:2px solid #eee;cursor:pointer;transition:all .2s;gap:6px;}
.country-card:hover{border-color:var(--blue);transform:translateY(-3px);box-shadow:var(--shadow);}
.country-flag{font-size:2.5rem;}
.country-name{font-size:.8rem;font-weight:600;text-align:center;}

.wheel-container{text-align:center;padding:20px 0;}
.wheel-outer{position:relative;width:280px;height:280px;margin:0 auto 20px;}
.wheel-pointer{position:absolute;top:-18px;left:50%;transform:translateX(-50%);font-size:2rem;z-index:5;filter:drop-shadow(0 2px 4px rgba(0,0,0,.3));}
.wheel-canvas{width:280px;height:280px;border-radius:50%;box-shadow:0 0 0 8px white,0 0 0 10px #ddd,var(--shadow-lg);}
.wheel-result{font-size:1.4rem;font-weight:800;min-height:40px;margin:10px 0;}

.town-header{text-align:center;margin-bottom:12px;}
.town-name{font-size:1.3rem;font-weight:800;}
.town-country{font-size:.85rem;color:var(--text-light);}
.map-grid{display:grid;grid-template-columns:repeat(6,1fr);gap:3px;background:#c8e6c9;padding:8px;border-radius:12px;border:3px solid #a5d6a7;}
.map-cell{aspect-ratio:1;background:#e8f5e9;border-radius:6px;display:flex;align-items:center;justify-content:center;font-size:1.2rem;cursor:pointer;transition:all .15s;border:2px solid transparent;position:relative;}
.map-cell:hover{background:#c8e6c9;border-color:var(--green);}
.map-cell.road{background:#e0e0e0;}
.map-cell.water{background:#bbdefb;cursor:default;}
.map-cell.tree{background:#a5d6a7;cursor:default;}
.map-cell.house{background:#fff9c4;border-color:var(--orange);}
.map-cell.shop{background:#f3e5f5;cursor:default;}
.map-cell.gym-cell{background:#ffccbc;cursor:default;}
.map-cell.available{border:2px dashed var(--green);animation:pulse 1.5s infinite;}
@keyframes pulse{0%,100%{opacity:1}50%{opacity:.5}}

.hub-header{display:flex;align-items:center;gap:12px;padding:14px;background:white;border-radius:var(--radius);box-shadow:var(--shadow);margin-bottom:14px;flex-wrap:wrap;}
.hub-avatar{font-size:2.2rem;}
.hub-info{flex:1;min-width:120px;}
.hub-name{font-weight:700;font-size:1.05rem;}
.hub-location{font-size:.75rem;color:var(--text-light);}
.hub-money{font-size:1.1rem;font-weight:800;color:var(--green-dark);background:#e8f5e9;padding:6px 12px;border-radius:10px;}
.hub-stage{width:100%;margin-top:6px;}
.stage-label{font-size:.75rem;font-weight:700;display:flex;justify-content:space-between;align-items:center;}
.stage-bar{height:8px;background:#f0f0f0;border-radius:4px;overflow:hidden;margin-top:3px;}
.stage-fill{height:100%;border-radius:4px;transition:width .5s ease;background:linear-gradient(90deg,var(--blue),var(--purple));}

.hub-nav{display:grid;grid-template-columns:1fr 1fr 1fr;gap:8px;margin-bottom:14px;}
.nav-btn{display:flex;flex-direction:column;align-items:center;padding:14px 6px;background:white;border-radius:14px;border:none;cursor:pointer;font-family:inherit;box-shadow:var(--shadow);transition:all .2s;gap:4px;}
.nav-btn:hover{transform:translateY(-2px);box-shadow:var(--shadow-lg);}
.nav-btn .nav-icon{font-size:1.6rem;}
.nav-btn .nav-label{font-size:.75rem;font-weight:600;color:var(--text);}

.stat-row{display:flex;align-items:center;gap:10px;padding:8px 0;border-bottom:1px solid #f0f0f0;}
.stat-row:last-child{border:none;}
.stat-icon{font-size:1.3rem;width:30px;text-align:center;}
.stat-info{flex:1;}
.stat-name{font-size:.8rem;font-weight:600;}
.stat-bar{height:10px;background:#f0f0f0;border-radius:5px;overflow:hidden;margin-top:3px;}
.stat-fill{height:100%;border-radius:5px;transition:width .5s ease;}
.stat-val{font-size:.75rem;font-weight:700;color:var(--text-light);width:35px;text-align:right;}

.gym-item{display:flex;align-items:center;gap:12px;padding:12px;background:#f8f8f8;border-radius:12px;margin-bottom:8px;}
.gym-item .stat-icon{font-size:1.5rem;}
.gym-info{flex:1;}
.gym-name{font-weight:700;font-size:.9rem;}
.gym-desc{font-size:.72rem;color:var(--text-light);}

#minigame-overlay{display:none;position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,.6);z-index:1000;align-items:center;justify-content:center;}
#minigame-overlay.active{display:flex;}
.minigame-box{background:white;border-radius:20px;padding:24px;max-width:380px;width:92%;text-align:center;box-shadow:var(--shadow-lg);animation:fadeUp .3s ease;max-height:90vh;overflow-y:auto;}
.minigame-title{font-size:1.2rem;font-weight:800;margin-bottom:6px;}
.minigame-desc{font-size:.8rem;color:var(--text-light);margin-bottom:16px;}
.minigame-area{min-height:120px;display:flex;align-items:center;justify-content:center;flex-wrap:wrap;background:#f8f8f8;border-radius:14px;margin-bottom:16px;position:relative;overflow:hidden;}
.click-target{font-size:3rem;cursor:pointer;transition:transform .1s;user-select:none;}
.click-target:active{transform:scale(.85);}
.minigame-counter{font-size:2rem;font-weight:900;color:var(--blue);}
.minigame-timer{font-size:.85rem;font-weight:600;color:var(--red);margin-bottom:8px;}
.eye-container{font-size:4rem;transition:all .3s;}
.eye-container.open{color:var(--red);}
.eye-container.closed{color:var(--green);opacity:.4;}
.sneak-instruction{font-size:.85rem;font-weight:600;margin-top:8px;}
.sneak-instruction.safe{color:var(--green);}
.sneak-instruction.danger{color:var(--red);}

.mem-btn{width:60px;height:60px;border-radius:14px;border:3px solid #ddd;cursor:pointer;margin:6px;transition:all .2s;font-size:1.6rem;display:inline-flex;align-items:center;justify-content:center;background:white;}
.mem-btn.flash{transform:scale(1.15);border-color:#333;box-shadow:0 0 20px rgba(0,0,0,.3);}
.mem-btn:active{transform:scale(.9);}

.pattern-grid{display:grid;gap:6px;margin:0 auto;}
.pattern-cell{aspect-ratio:1;border-radius:10px;background:#e0e0e0;cursor:pointer;transition:all .2s;border:2px solid #ccc;}
.pattern-cell.lit{background:var(--yellow);border-color:var(--orange);}
.pattern-cell.selected{background:var(--blue-light);border-color:var(--blue);}
.pattern-cell.correct{background:var(--green-light);border-color:var(--green);}
.pattern-cell.wrong{background:#ffcdd2;border-color:var(--red);}

.reaction-target{position:absolute;font-size:2.5rem;cursor:pointer;transition:transform .1s;user-select:none;animation:popIn .2s ease;}
@keyframes popIn{from{transform:scale(0)}to{transform:scale(1)}}

.job-card{display:flex;align-items:center;gap:12px;padding:14px;background:#f8f8f8;border-radius:12px;margin-bottom:8px;}
.job-icon{font-size:1.8rem;}
.job-info{flex:1;}
.job-title{font-weight:700;font-size:.9rem;}
.job-pay{font-size:.75rem;color:var(--green-dark);font-weight:600;}
.job-req{font-size:.7rem;color:var(--text-light);}

.shop-tabs{display:flex;gap:6px;overflow-x:auto;padding-bottom:10px;margin-bottom:12px;-webkit-overflow-scrolling:touch;}
.shop-tabs::-webkit-scrollbar{display:none;}
.shop-tab{flex-shrink:0;padding:8px 14px;border-radius:20px;border:2px solid #eee;background:white;cursor:pointer;font-size:.78rem;font-weight:700;font-family:inherit;transition:all .2s;white-space:nowrap;}
.shop-tab.active{background:var(--blue);color:white;border-color:var(--blue-dark);}
.shop-tab.locked{opacity:.5;cursor:not-allowed;background:#f0f0f0;}
.shop-item{display:flex;align-items:center;gap:12px;padding:14px;background:#f8f8f8;border-radius:12px;margin-bottom:8px;}
.shop-icon{font-size:2rem;}
.shop-info{flex:1;}
.shop-name{font-weight:700;font-size:.9rem;}
.shop-desc{font-size:.72rem;color:var(--text-light);}
.shop-price{font-weight:800;color:var(--orange);font-size:.9rem;white-space:nowrap;}

.pets-row{display:flex;gap:8px;flex-wrap:wrap;margin-top:8px;}
.pet-badge{display:flex;align-items:center;gap:4px;padding:4px 10px;background:#fff3e0;border-radius:20px;font-size:.8rem;font-weight:600;border:1px solid #ffe0b2;}

.energy-bar{display:flex;align-items:center;gap:8px;padding:8px 14px;background:#fff8e1;border-radius:10px;margin-bottom:12px;}
.energy-label{font-size:.75rem;font-weight:600;color:var(--orange);}
.energy-track{flex:1;height:12px;background:#fff3e0;border-radius:6px;overflow:hidden;border:1px solid #ffe0b2;}
.energy-fill{height:100%;background:linear-gradient(90deg,var(--orange),var(--yellow));border-radius:6px;transition:width .4s;}
.energy-val{font-size:.8rem;font-weight:700;color:var(--orange);}

.ach-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:8px;}
.ach-card{padding:12px 8px;border-radius:12px;text-align:center;transition:all .2s;}
.ach-card.earned{background:#e8f5e9;border:2px solid var(--green-light);}
.ach-card.locked{background:#f5f5f5;border:2px solid #eee;opacity:.5;}
.ach-emoji{font-size:1.6rem;}
.ach-name{font-size:.65rem;font-weight:700;margin-top:4px;}

.adv-card{display:flex;align-items:center;gap:12px;padding:14px;background:#f8f8f8;border-radius:12px;margin-bottom:8px;}
.adv-icon{font-size:2rem;}
.adv-info{flex:1;}
.adv-name{font-weight:700;font-size:.9rem;}
.adv-desc{font-size:.72rem;color:var(--text-light);}
.adv-cost{font-size:.72rem;color:var(--orange);font-weight:600;}

.biz-item{display:flex;align-items:center;gap:10px;padding:8px 12px;background:#e3f2fd;border-radius:10px;margin-bottom:6px;font-size:.8rem;}
.biz-income{font-weight:700;color:var(--green-dark);margin-left:auto;}

@media(max-width:420px){
  .country-grid{grid-template-columns:repeat(2,1fr);}
  .map-grid{grid-template-columns:repeat(5,1fr);}
  .wheel-outer{width:240px;height:240px;}
  .wheel-canvas{width:240px;height:240px;}
  .ach-grid{grid-template-columns:repeat(2,1fr);}
}
</style>
</head>
<body>
<div id="app">
  <div id="title-screen" class="screen active">
    <div class="title-globe">&#x1F30D;</div>
    <div class="game-title">Spin-a-Life</div>
    <div class="game-subtitle">World Edition &#x2014; Mega Expansion</div>
    <div class="card">
      <div class="card-title">&#x1F6C2; Select Your Passport</div>
      <div class="passport-grid" id="passport-grid"></div>
    </div>
  </div>

  <div id="new-passport-screen" class="screen">
    <div class="card" style="text-align:center;">
      <div style="font-size:3rem;margin-bottom:8px;">&#x1F6C2;</div>
      <div class="card-title" style="justify-content:center;">Create New Passport</div>
      <input type="text" class="name-input" id="name-input" placeholder="Enter your name..." maxlength="20">
      <div style="margin-top:14px;display:flex;gap:8px;">
        <button class="btn btn-blue btn-block" onclick="createPassport()">Create! &#x2708;&#xFE0F;</button>
        <button class="btn btn-red btn-sm" onclick="showScreen('title-screen');renderPassports();">Back</button>
      </div>
    </div>
  </div>

  <div id="country-screen" class="screen">
    <div class="card">
      <div class="card-title">&#x1F5FA;&#xFE0F; Choose Your Country</div>
      <div class="country-grid" id="country-grid"></div>
    </div>
    <button class="btn btn-red btn-sm" onclick="showScreen('title-screen');renderPassports();">Back</button>
  </div>

  <div id="wheel-screen" class="screen">
    <div class="card">
      <div class="wheel-container">
        <div style="font-size:.9rem;font-weight:600;margin-bottom:10px;" id="wheel-country-label">&#x1F3AF; Spinning for your town...</div>
        <div class="wheel-outer">
          <div class="wheel-pointer">&#x1F4CD;</div>
          <canvas class="wheel-canvas" id="wheel-canvas" width="280" height="280"></canvas>
        </div>
        <div class="wheel-result" id="wheel-result"></div>
        <button class="btn btn-orange btn-lg" id="spin-btn" onclick="spinWheel()">&#x1F3B0; SPIN THE WHEEL!</button>
      </div>
    </div>
  </div>

  <div id="town-screen" class="screen">
    <div class="card">
      <div class="town-header">
        <div class="town-name" id="town-name-display"></div>
        <div class="town-country" id="town-country-display"></div>
        <div style="font-size:.8rem;color:var(--green-dark);font-weight:600;margin-top:4px;">Click a green square to build your house! &#x1F3E0;</div>
      </div>
      <div class="map-grid" id="town-map"></div>
      <div style="margin-top:12px;text-align:center;">
        <button class="btn btn-blue" id="confirm-house-btn" style="display:none;" onclick="confirmHouse()">Confirm House Spot &#x2705;</button>
      </div>
    </div>
  </div>

  <div id="hub-screen" class="screen">
    <div class="hub-header">
      <div class="hub-avatar">&#x1F9D1;</div>
      <div class="hub-info">
        <div class="hub-name" id="hub-name"></div>
        <div class="hub-location" id="hub-location"></div>
      </div>
      <div class="hub-money" id="hub-money">$100</div>
      <div class="hub-stage" id="hub-stage"></div>
    </div>
    <div class="energy-bar">
      <div class="energy-label">&#x26A1; Energy</div>
      <div class="energy-track"><div class="energy-fill" id="energy-fill"></div></div>
      <div class="energy-val" id="energy-val">100</div>
    </div>
    <div class="hub-nav" id="hub-nav"></div>
    <div id="hub-panel"></div>
  </div>
</div>

<div id="minigame-overlay">
  <div class="minigame-box" id="minigame-box"></div>
</div>
